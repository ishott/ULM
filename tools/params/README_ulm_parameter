## Author : Ishu
## Date: 02/07/2014
## This file describes the steps to generate ulm parameters ( divided into two categories viz. NOAH & SAC parameters) from the original files (region : global) provided by youlong for GDIS project and how to run ulm.

(i) Directory_List:
	source_code : hydra:/raid3/ishu/BPA/ulm_git/ULM
	Input_file_ulm :  hydra:/source_code_dir/ulm.input.CRB.0.0625.template
	Scripts_dir : hydra:/raid3/ishu/BPA/tools
	Parameters_dir : hydra:/raid3/ishu/BPA/parameter_files/CRB_PARAMS
        Grid_description : hydra:/raid3/ishu/BPA/parameter_files/grid_0.0625_deg_pnw_description.txt

(ii) Run_ulm : $source_code/ulm $Input_file_ulm

(ii) Process_Scripts :
	(a) Parameter_Estimation_Scripts
		NOAH_PARAMETERS:
            		$Scripts_dir/estimate_ulm_parameter_CRB_from_pnw.sh
		SAC PARAMETERS:
			$Scripts_dir/derive_sac_parameters.pl
(iii) Steps for NOAH parameter estimation:

1) mask_file : /raid3/ishu/BPA/parameter_files/domain_CRB_matched_flowd2860.asc 

(2) $Parameters_dir/soil_layers/noah_soil_layers.CRB.asc
Constant number of soil layers for each grid cell (i.e. 4 layers)

(3) $Parameters_dir/soil_depth/soil_depth.CRB.asc$layer
Total 4 files. One file for each layer.
Constant depth values for each layers (i.e. 0.1 (1st layer) 0.3 (2nd layer) 0.6 (3rd layer) 1.0 (4th layer)

(4) $Parameters_dir/soil_type/soiltype_statsgo.CRB.asc

4.1: Original file  /raid3/ishu/BPA/parameter_files/soil_parameters/topsoil_fao.30s.orig
4.2: This file is in binary format and at 30 sec resolution using Bart's script
##fconvert uc asc INFILE OUTFILE COL_NUMBERS ROW_NUMBERS
## COL_NUMBERS = 43200 for 30 sec resolution file
## ROW_NUMBERS = 21600 for 30 sec resolution file
##fconvert uc asc INFILE OUTFILE 43200 21600

(5) $Parameters_dir/slope_type/slopetype.CRB.asc 
    Constant slope 3

(6) $Parameters_dir/soil_lower_T/noah_soil_lower_T.CRB.asc
This file was generated by using VIC soil parameter files. The soil average temperature values of the 3rd soil layer of VIC was used.
(7) noah_vegtype_UMD
7.1: Original file obtained from GDIS Project
7.2: The above file is in binary format so it was converted to ascii format as described in 4.2 and aggregated to 0.0625 resolution

9) Albedo (Total 12 files, 1 file for each month)
9.1: Original file from GDIS: <Parent directory>albedo_1x1.dat This file has four rows. Those are the albedo values as of 31 Jan,30 Apr, 31 Jul, and 31 Oct at 1 deg file (albedo_1x1.nc)
From these files albedo for each month has been obtained using weighted avergae method.

## ncflint -w 0.667,0.333 ifile ofile


(10) max_snow_albedo
10.1: Original file from GDIS:/global_snoalb.1x1.grb
10.2: I first converted this file in grib format to netcdf using cdo.
10.3: Then I interpolated this file to 0.0625 deg using cdo as in 4.3
10.4: Finally I converted the netcdf file at 0.0625 deg to lat lon value and then to mask: 

11. Elevation, snowband files  are taken from VIC (from Matt)

SAC Parameters are estimated using soil_type and vegetation parameters of NOAH parameters

script as mentioned above under parameter estimation script : SAC PARAMETERS

